import{lpFetchAPI}from"../utils";import API from"../api";function widgetRestAPI(){const e=document.querySelectorAll(".learnpress-widget-wrapper");if(!e.length)return;e.forEach((e=>{e.classList.contains("learnpress-widget-wrapper__restapi")&&(e=>{const t=e.dataset.widget?JSON.parse(e.dataset.widget):"",a=API.frontend.apiWidgets,s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,params_url:lpData.urlParams})};0!==parseInt(lpData.user_id)&&(s.headers["X-WP-Nonce"]=lpData.nonce),lpFetchAPI(a,s,{before:()=>{},success:t=>{const{data:a,status:s,message:r}=t;a&&"success"===s?e.insertAdjacentHTML("afterbegin",a):r&&e.insertAdjacentHTML("afterbegin",`<div class="lp-ajax-message error" style="display:block">${r}</div>`)},error:e=>{},completed:()=>{e.querySelector(".lp-skeleton-animation").remove()}})})(e)}))}document.addEventListener("DOMContentLoaded",(function(e){widgetRestAPI()}));